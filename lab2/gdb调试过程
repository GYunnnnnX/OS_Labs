ps aux | grep qemu

终端1:
make debug
终端2:
pgrep -f qemu-system-riscv64
sudo gdb
attach 进程ID
handle SIGPIPE nostop noprint
break riscv_cpu_tlb_fill
p/x address
bt //调用栈

break get_physical_address
//三级映射（1）
break /home/lin/workspace/qemu-4.1.1/target/riscv/cpu_helper.c:243
p/x pte_addr

//三级映射（2）
break /home/lin/workspace/qemu-4.1.1/target/riscv/cpu_helper.c:255
p/x ppn

//三级映射（3）
break /home/lin/workspace/qemu-4.1.1/target/riscv/cpu_helper.c:335
p/x ppn
p/x vpn
p/x ptshift
p/x *physical
p/x addr
p/x ((*physical) + (addr & 0xfff))

break tlb_set_page（填TLB）
p/x vaddr （页对齐的虚拟地址）
p/x paddr （页对齐的物理地址）
p/x size （映射页大小）
p/x prot （权限位掩码）

终端3：
make gdb
set remotetimeout unlimited
break kern_init
c
d

QEMU 为不同访问类型维护独立 TLB（取指/读/写），同一页对“写”是一次填充，对“取指/读”可能还会再填一次
因此即使同一页，首次“取指”的填充不会避免后续“写”的填充。